<app-header></app-header>

<div class="pokedex">
  <h2 class="title">Mein Pokédex</h2>

  <div class="filters">
    <input
      class="filter-control"
      type="text"
      [(ngModel)]="searchTerm"
      placeholder="Pokémon suchen..."
    />

    <select class="filter-control" [(ngModel)]="selectedType">
      <option value="">Alle Typen</option>
      <option *ngFor="let type of getAllTypes()" [value]="type">
        {{ type | titlecase }}
      </option>
    </select>
  </div>

  <div class="pokemon-grid">
    <div
      class="pokemon-card-wrapper"
      *ngFor="let entry of filteredDex(); let index = index"
      [ngClass]="getAnimationClass(index)"
      [style.--delay]="(index * 100) + 'ms'"
    >
      <div class="pokemon-card"
           [ngStyle]="getCardBackground(entry.types)"
           (click)="openDetails(entry)">
        <img class="sprite"
             [src]="entry.spriteUrl || 'https://via.placeholder.com/80?text=' + entry.id"
             [alt]="entry.name" />
        <div class="name">{{ entry.name || '???' | titlecase }}</div>
        <div class="id">#{{ entry.id }}</div>
      </div>
    </div>
  </div>
</div>

<div class="pokemon-detail-overlay" *ngIf="selectedPokemon" (click)="closeDetails()">
  <div class="detail-card slide-in" (click)="$event.stopPropagation()">
    <img
      class="detail-sprite"
      [src]="selectedPokemon.showdownSpriteUrl || selectedPokemon.spriteUrl || ('https://via.placeholder.com/200?text=' + selectedPokemon.id)"
      [alt]="selectedPokemon.name"
    />
    <h3 class="detail-title">{{ selectedPokemon.name | titlecase }} <span class="detail-id">#{{ selectedPokemon.id }}</span></h3>
    <div class="detail-stats">
      <div><strong>Größe:</strong> {{ selectedPokemon.height ?? '—' }}</div>
      <div><strong>Gewicht:</strong> {{ selectedPokemon.weight ?? '—' }}</div>
      <div><strong>Typen:</strong> {{ (selectedPokemon.types?.length ? selectedPokemon.types.join(', ') : '—') }}</div>
    </div>
    <button class="detail-close" (click)="closeDetails()">Schließen</button>
  </div>
</div>

<div class="back-button">
  <app-back-button></app-back-button>
</div>
